<div class="consulta-container">
  <h2>Consulta NFSe</h2>
  
  <div class="form-group">
    <label>Tipo de Busca:</label>
    <select [(ngModel)]="tipoBusca">
      <option value="nfse">Número NFSe</option>
      <option value="credito">Número Crédito</option>
    </select>
  </div>

  <div class="form-group">
    <label>Valor:</label>
    <input maxlength="7" type="text" [(ngModel)]="valorBusca" placeholder="Digite o valor para busca">
     <div *ngIf="mensagemErro" class="erro-validacao">
    {{mensagemErro}}
     </div>
  </div>

  <div class="buttons">
    <button (click)="consultar()" [disabled]="loading || debounceAtivo">Consultar</button>
    <button (click)="limpar()">Limpar</button>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Carregando...</p>
  </div>

  <div *ngIf="!loading && resultados.length > 0" class="resultados">
    <h3>Resultados:</h3>
    <div *ngFor="let item of resultados" class="resultado-item">
      <p><strong>Número Crédito:</strong> {{item.numeroCredito}}</p>
      <p><strong>Número NFSe:</strong> {{item.numeroNfse}}</p>
      <p><strong>Data Constituição:</strong> {{item.dataConstituicao}}</p>
      <p><strong>Valor ISSQN:</strong> {{item.valorIssqn | currency:'BRL'}}</p>
      <p><strong>Tipo Crédito:</strong> {{item.tipoCredito}}</p>
      <p><strong>Simples Nacional:</strong> {{item.simplesNacional}}</p>
      <p><strong>Alíquota:</strong> {{item.aliquota}}%</p>
      <p><strong>Valor Faturado:</strong> {{item.valorFaturado | currency:'BRL'}}</p>
      <p><strong>Valor Dedução:</strong> {{item.valorDeducao | currency:'BRL'}}</p>
      <p><strong>Base Cálculo:</strong> {{item.baseCalculo | currency:'BRL'}}</p>
      <hr>
    </div>
  </div>

  <!-- Mensagem quando vazio -->
  <div *ngIf="!loading && resultados.length === 0 && valorBusca.trim() && consultaRealizada" class="mensagem-vazio">
    <p>Nenhum resultado encontrado para a busca.</p>
  </div>
</div>